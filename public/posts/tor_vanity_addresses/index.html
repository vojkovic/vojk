<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title>
  Tor Vanity Addresses · Brock Vojkovic
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Brock Vojkovic">
<meta name="description" content="
Originally written in October 2023, but unpublished until August 2024. This post discusses Tor v3 address, without mention of any legacy formats.

  What is a Tor address?
  
    
    Link to heading
  

A reason the Tor Network is so resistant to censorship stems from its inherently decentralised architecture. Unlike a traditional DNS which has a centralised governance structure with organisations like ICANN having a say in the domain name allocation process, Tor&rsquo;s decentralised nature means there&rsquo;s no single authority governing the issuance of onion addresses. But if there&rsquo;s no authority, how are Tor addresses created?">
<meta name="keywords" content="blog,developer,personal">



<link rel="canonical" href="http://localhost:1313/posts/tor_vanity_addresses/">


<link rel="preload" href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.css" media="screen">






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.css" media="screen">
  



 




<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">










</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      Brock Vojkovic
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/posts/">Posts</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://as44354.net">AS44354</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://priv.au">Search</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://chef.priv.au">Chef</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="http://localhost:1313/posts/tor_vanity_addresses/">
              Tor Vanity Addresses
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa fa-calendar" aria-hidden="true"></i>
              <time datetime="2024-08-27T00:00:00Z">
                August 27, 2024
              </time>
            </span>
            <span class="reading-time">
              <i class="fa fa-clock-o" aria-hidden="true"></i>
              6-minute read
            </span>
          </div>
          
          
          <div class="tags">
  <i class="fa fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/tor/">Tor</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/crypto/">Crypto</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/web/">Web</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <hr>
<p><em>Originally written in October 2023, but unpublished until August 2024. This post discusses Tor v3 address, without mention of any legacy formats.</em></p>
<h1 id="what-is-a-tor-address">
  What is a Tor address?
  <a class="heading-link" href="#what-is-a-tor-address">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>A reason the Tor Network is so resistant to censorship stems from its inherently decentralised architecture. Unlike a traditional DNS which has a centralised governance structure with organisations like ICANN having a say in the domain name allocation process, Tor&rsquo;s decentralised nature means there&rsquo;s no single authority governing the issuance of onion addresses. But if there&rsquo;s no authority, how are Tor addresses created?</p>
<p>Tor addresses, also referred to as &ldquo;onion addresses&rdquo;, are generated using a cryptographic process. A server creates a key pair, specifically using Ed25519. This generates two keys: a public key and a private key. The private key is kept secret and is used for proving ownership of the public key. The onion address is then created using the public key. This makes onion addresses self-certifying.</p>
<p>Above is the basic definition, in practice it&rsquo;s a little more complicated than that. There&rsquo;s also a few constants appended to the start and end of the a hashed public key which is all then concatenated together and then encoded into a human-friendly format with Base32. This creates a 56 character string which then becomes the hostname. <a href="https://github.com/vojkovic/OnionDomainGen/blob/main/main.py"  class="external-link" target="_blank" rel="noopener">I wrote a python script if you&rsquo;re interested in the details.</a></p>
<p>One interesting fact about Tor addresses is because they are Base32 encoded which uses an alphabet of A–Z, followed by 2–7, it&rsquo;s impossible for a Tor address to have the digits 0, 1, 8 or 9.</p>
<p>Here are some examples of your typical Tor addresses:</p>
<ul>
<li>py5hfssnlc62ou5ymrgkdsk3nqjpvmqyab2embfeokehzhqwrqxvrtqd.onion</li>
<li>nl73tmcncviy2tokayao4y3nmk6o7sza2gjmrow7b2l6uemfpd66rqqd.onion</li>
<li>3vf2humev2rc3ulsxqj7qui35rkyqforv5lddbrneaoewnrvyl6wfwid.onion</li>
</ul>
<p>Many people would agree that they&rsquo;re pretty unappealing to look at. This is because they&rsquo;re a product of a cryptographic process that wasn&rsquo;t built for easy memorisation.</p>
<p>This is where vanity addresses come in.</p>
<hr>
<h1 id="what-are-tor-vanity-addresses">
  What are Tor vanity addresses?
  <a class="heading-link" href="#what-are-tor-vanity-addresses">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>From the <a href="https://community.torproject.org/onion-services/advanced/vanity-addresses/"  class="external-link" target="_blank" rel="noopener">Tor Project</a>:</p>
<blockquote>
<p>&ldquo;Vanity&rdquo; onion addresses are a partial workaround for the difficulty of memorizing the 56-char long onion addresses.</p></blockquote>
<p>Most commonly, vanity addresses start with a pre-chosen number of characters. Usually the website admin choose this prefix to be a meaningful name related to a specific Onion Service. For example, the onion location for my old invidious instance was</p>
<p><code>invidiousge2cq2qegp4vdzsfu6mvpqdf6dtcyzmqbv7yx2spvkkajad.onion</code></p>
<p>The first nine characters spell the name of the service, &lsquo;invidious&rsquo;. There&rsquo;s a reason only nine characters are being used as a prefix, I&rsquo;ll explain why later.</p>
<hr>
<h1 id="mining-vanity-addresses">
  Mining Vanity Addresses
  <a class="heading-link" href="#mining-vanity-addresses">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>The current gold standard in mining vanity addresses is <a href="https://github.com/cathugger/mkp224o"  class="external-link" target="_blank" rel="noopener">mkp224o</a>. Depending on your hardware, this tool can generate up to hundreds of millions of Ed25519 keypairs each second. It then converts the public key into Base32 and checks the result for a desired prefix. It&rsquo;s a very handy bit of software and makes you appreciate the incredible speed of modern processors.</p>
<h2 id="get-started">
  Get started
  <a class="heading-link" href="#get-started">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>This section will cover a lot of the content mentioned in the <a href="https://github.com/cathugger/mkp224o/blob/master/README.md"  class="external-link" target="_blank" rel="noopener">README</a>.</p>
<h3 id="building-mkp224o-from-source">
  Building mkp224o from source:
  <a class="heading-link" href="#building-mkp224o-from-source">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<h4 id="1-install-dependencies">
  1) Install Dependencies:
  <a class="heading-link" href="#1-install-dependencies">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<ul>
<li>C99 compatible compiler (gcc or clang works)</li>
<li>libsodium (with headers)</li>
<li>GNU make</li>
<li>GNU autoconf</li>
</ul>
<h5 id="for-debian-based-systems-ubuntu-debian-mint">
  For Debian-based systems (Ubuntu, Debian, Mint):
  <a class="heading-link" href="#for-debian-based-systems-ubuntu-debian-mint">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ apt install gcc libc6-dev libsodium-dev make autoconf
</span></span></code></pre></div><h5 id="for-arch-based-systems-arch-linux-manjaro-artix">
  For Arch-based systems (Arch Linux, Manjaro, Artix):
  <a class="heading-link" href="#for-arch-based-systems-arch-linux-manjaro-artix">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ pacman -S gcc libsodium make autoconf
</span></span></code></pre></div><h4 id="2-clone-the-git-repository">
  2) Clone the Git Repository
  <a class="heading-link" href="#2-clone-the-git-repository">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ git clone https://github.com/cathugger/mkp224o.git <span class="o">&amp;&amp;</span> <span class="nb">cd</span> mkp244o
</span></span></code></pre></div><h4 id="3-generate-the-makefile">
  3) Generate the makefile
  <a class="heading-link" href="#3-generate-the-makefile">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<p>If there isn&rsquo;t already a configure script, run</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ./autogen.sh
</span></span></code></pre></div><p>Now you can run the configure script to generate the makefile:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ./configure
</span></span></code></pre></div><p>Note: On *BSD platforms, you may need to specify extra include/library paths:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ./configure <span class="nv">CPPFLAGS</span><span class="o">=</span><span class="s2">&#34;-I/usr/local/include&#34;</span> <span class="nv">LDFLAGS</span><span class="o">=</span><span class="s2">&#34;-L/usr/local/lib&#34;</span>
</span></span></code></pre></div><p>In a later section of this post we&rsquo;re going to be passing different parameters to optimise mkp224o for your processor. If you run <code>./configure --help</code> you can see all the available options.</p>
<h4 id="4-make-mkp224o">
  4) Make mkp224o
  <a class="heading-link" href="#4-make-mkp224o">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h4>
<p>Now you can run make to build mkp244o. (gmake in *BSD platforms).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ make -j<span class="k">$(</span>nproc<span class="k">)</span>
</span></span></code></pre></div><p>This will now create an executable named <code>mkp224o</code>.</p>
<h3 id="using-mkp224o">
  Using mkp224o:
  <a class="heading-link" href="#using-mkp224o">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Before running, mkp224o will first need to be provided with a list of filters. Filters can be specified as command line arguments: e.g. <code>./mkp224o example</code>. You can also use multiple filters at the same time: e.g. <code>./mkp224o example1 example2 example3</code>. Alternatively, filters can also be loaded from a file using the <strong>-f</strong> switch: e.g. <code>./mkp224o -f filters.txt</code>.</p>
<p>When mkp224o matches a hostname to one of your filters, it will create a directory with secret/public keys and the hostname. By default, the working directory is the current directory, but that can be overridden with the <strong>-d</strong> switch. e.g. <code>./mkp224o -d ./output/ example</code></p>
<p>There&rsquo;s also the <strong>-s</strong> switch, which enables the printing of statistics, which will come in handy when we&rsquo;re benchmarking different Ed25519 implementations later on.</p>
<hr>
<h1 id="optimisation">
  Optimisation
  <a class="heading-link" href="#optimisation">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>One large optimisation we can make is to search for multiple prefixes at the same time. In terms of the computing cost required, the encryption is expensive whilst string comparisons are cheap. Every address generated should be tested against everything that you can imagine ever looking for, otherwise it&rsquo;s a wasted opportunity.</p>
<hr>
<h1 id="estimating-the-time-required">
  Estimating the time required
  <a class="heading-link" href="#estimating-the-time-required">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>As mentioned, Tor addresses are created with Base32 encoding. Therefore, the probability for an address to start with a prefix of n letters would be $\frac{1}{32^n}$. When I ran a benchmark of my processor, I found that it would roughly generate 100,000,000 addresses each second. Therefore, I was able to create a function to calculate to estimate how many seconds it would take on average to find an address with a prefix of n letters.</p>
<p>$time(n) = \frac{\text{Total number of possible addresses with the specified prefix length}}{\text{Processing rate (addresses per second)}} = \frac{32^n}{100,000,000}$</p>
<p>Here&rsquo;s a table for how many long it will take on average to find an onion address with an n letter prefix on a typical modern desktop processor. If n is less than 5, it&rsquo;s pretty much instantaneous.</p>
<p>$
\begin{array}{|c|c|}
\hline
\text{n} &amp; \text{Time} \\
\hline
5 &amp; 335\text{ ms}\\
6 &amp; 10.7\text{ secs}\\
7 &amp; 5.73\text{ mins}\\
8 &amp; 3.05\text{ hours}\\
9 &amp; 4.07\text{ days}\\
10 &amp; 4.28\text{ months}\\
11 &amp; 11.4\text{ years}\\
12 &amp; 365\text{ years}\\
13 &amp; 11700\text{ years}\\
\hline
\end{array}
$</p>
<hr>
<h1 id="final-thoughts">
  Final Thoughts
  <a class="heading-link" href="#final-thoughts">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>I did some back of the napkin math for the limits of Tor vanity addresses. As you can see from the table above, as you increase the number of letters in your prefix by one, it exponentially increases the time that the task will take by a factor of 32. Your average home user can realistically only generate a 9 character tor address. For a company or really dedicated home user, they could definitely reach a 10, maybe an 11 character prefix. For example, Proton&rsquo;s tor address is 10 characters:</p>
<p><a href="https://protonmailrmez3lotccipshtkleegetolb73fuirgj7r4o4vfu7ozyd.onion/"  class="external-link" target="_blank" rel="noopener">protonmailrmez3lotccipshtkleegetolb73fuirgj7r4o4vfu7ozyd.onion</a></p>
<p>A single server processor alone is able to do 2-3x the number of operations per second than a typical modern consumer processor. At the scale of a datacenter with hundreds of processors, it would be trivial to find a 11 character prefix. I predict the largest tor vanity address we could ever see in the next decade will be 12 characters.</p>
<h1 id="sources">
  Sources:
  <a class="heading-link" href="#sources">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p><a href="https://github.com/torproject/torspec/blob/main/rend-spec-v3.txt"  class="external-link" target="_blank" rel="noopener">https://github.com/torproject/torspec/blob/main/rend-spec-v3.txt</a></p>
<p><a href="https://en.wikipedia.org/wiki/.onion"  class="external-link" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/.onion</a></p>
<p><a href="https://nymity.ch/onion-services/pdf/sec18-onion-services.pdf"  class="external-link" target="_blank" rel="noopener">https://nymity.ch/onion-services/pdf/sec18-onion-services.pdf</a></p>
<p><a href="https://github.com/alecmuffett/eotk/blob/master/docs.d/TIPS-FOR-MINING-ONIONS.md"  class="external-link" target="_blank" rel="noopener">https://github.com/alecmuffett/eotk/blob/master/docs.d/TIPS-FOR-MINING-ONIONS.md</a></p>
<p><a href="https://en.wikipedia.org/wiki/Base32"  class="external-link" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Base32</a></p>
<p><a href="https://datatracker.ietf.org/doc/html/rfc4648#page-10"  class="external-link" target="_blank" rel="noopener">https://datatracker.ietf.org/doc/html/rfc4648#page-10</a></p>
<p><a href="https://tor.stackexchange.com/questions/23119/why-do-all-the-generated-tor-v3-vanity-addresses-end-with-d"  class="external-link" target="_blank" rel="noopener">https://tor.stackexchange.com/questions/23119/why-do-all-the-generated-tor-v3-vanity-addresses-end-with-d</a></p>
<p><a href="https://www.desmos.com/calculator/wzwuwtydfm"  class="external-link" target="_blank" rel="noopener">https://www.desmos.com/calculator/wzwuwtydfm</a></p>

      </div>


      <footer>
        


        
        
        
        
        
      </footer>
    </article>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"
    integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"
    integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"
    integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body,
      {
        delimiters: [
          {left: '$$', right: '$$', display:true},
          {left: '$', right: '$', display:false},
          {left: '\\(', right: '\\)', display: false},
          {left: '\\[', right: '\\]', display: true}
        ]
      }
    );"></script>
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2025
     Brock Vojkovic 
    ·
    
      Licensed under <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a>
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.js"></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
